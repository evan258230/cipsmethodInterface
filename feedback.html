<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feedback - Procedural Complexity Calculator</title>
  <link rel="stylesheet" href="feedback.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=DM+Sans:wght@500;600&display=swap" rel="stylesheet">
</head>

<body>

  <!-- Header -->
  <header class="header">
    <div class="header-title">Procedural Complexity Calculator Tool</div>
    <div class="user-profile">
      <div class="user-avatar"></div>
      <div class="user-name">UserProfile</div>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar">
    <button id="newProjectBtn" class="new-project-btn">
      <span class="plus-icon">+</span> New Project
    </button>

    <div id="projectList" class="projects-list">
    
    </div>

    <div class="sidebar-bottom">
      <a href="feedback.html" class="feedback-link">Send Us Feedback!</a>
      <a href="logIn.html" class="logout-link">Logout â†ª</a>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <h1 class="page-heading">We value your opinion and would love to hear from you.</h1>

    <div class="main-card">
      <div class="rating">
        <span class="star" data-value="1">&#9733;</span>
        <span class="star" data-value="2">&#9733;</span>
        <span class="star" data-value="3">&#9733;</span>
        <span class="star" data-value="4">&#9733;</span>
        <span class="star" data-value="5">&#9733;</span>
      </div>

      <form class="feedback-form">
        <label for="email" class="feedback-label">Email (Optional):</label>
        <input type="email" id="email" class="feedback-input" placeholder="Enter email">

        <label for="feedback" class="feedback-label">Feedback:</label>
        <textarea id="feedback" class="feedback-textarea" placeholder="Please fill in your answer"></textarea>

        <div class="feedback-actions">
          <button class="cancel-btn" type="button">Cancel</button>
          <button class="submit-btn" type="submit" disabled>Submit</button>
        </div>
      </form>
    </div>
  </main>

</main>

  <script src="main.js" defer></script>
  <script>
    const stars = document.querySelectorAll('.star');
    stars.forEach((star, index) => {
      star.addEventListener('click', () => {
        stars.forEach((s, i) => {
          s.classList.toggle('active', i <= index);
        });
      });
    });


    const feedbackTextarea = document.querySelector('#feedback');
    const submitBtn = document.querySelector('.submit-btn');
    const feedbackForm = document.querySelector('.feedback-form');

    function updateSubmitState() {
      const hasText = feedbackTextarea && feedbackTextarea.value.trim().length > 0;
      if (submitBtn) {
        submitBtn.disabled = !hasText;
        submitBtn.classList.toggle('enabled', hasText);
      }
    }

    if (feedbackTextarea) {

      updateSubmitState();
      feedbackTextarea.addEventListener('input', updateSubmitState);
    }


    if (feedbackForm) {
      feedbackForm.addEventListener('submit', (e) => {
        e.preventDefault();
        if (submitBtn && submitBtn.disabled) return; 

        // count active stars
        const activeStars = Array.from(document.querySelectorAll('.star.active')).length;
        const rating = activeStars || 0;
        const feedbackText = feedbackTextarea ? feedbackTextarea.value.trim() : '';
        const userEmail = document.querySelector('#email') ? document.querySelector('#email').value.trim() : '';

        const to = 'yhpark@tamu.edu';
        const subject = `Feedback on CIPS Method Web Interface - ${rating}/5`;
        let body = '';
        if (userEmail) body += `From: ${userEmail}\n\n`;
        body += feedbackText || '(No additional comments)';

        const mailto = `mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

        const popup = window.open(mailto, 'sendFeedback', 'width=700,height=600,menubar=no,toolbar=no,location=no,status=no');
        if (popup) {
    
          setTimeout(() => {
            try { popup.close(); } catch (err) {  }
            try { window.focus(); } catch (err) {  }
          }, 800);
        } else {

          window.location.href = mailto;
        }
      });
    }
  </script>
</body>
</html>
